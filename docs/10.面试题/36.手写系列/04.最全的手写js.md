---
title: 最全的手写js
date: 2021-12-05 14:45:45
permalink: /pages/0233b5d06cbe5/
categories:
  - 面试题
  - 手写系列
tags:
  -
---

手写一定要重视！！！

<!-- more -->

## 实现一个 compose 函数

```js
// 用法如下:
function fn1(x) {
  return x + 1;
}
function fn2(x) {
  return x + 2;
}
function fn3(x) {
  return x + 3;
}
function fn4(x) {
  return x + 4;
}
const a = compose(fn1, fn2, fn3, fn4);
console.log(a(1)); // 1+4+3+2+1=11

// 就是把函数按倒序执行
function compose(...fn) {
  return fn.reduce(
    (pre, cur) => {
      return (...args) => {
        // 主要看题目是顺序执行，还是倒序执行
        return pre(cur(...args));
      };
    },
    (v) => v
  );
}
```

## 模拟实现 instanceof

```js
function myInstanceof(left, right) {
  //基本数据类型直接返回false
  if (typeof left !== "object" || left === null) return false;
  //getProtypeOf是Object对象自带的一个方法，能够拿到参数的原型对象
  let proto = Object.getPrototypeOf(left);
  while (true) {
    //查找到尽头，还没找到
    if (proto == null) return false;
    //找到相同的原型对象
    if (proto == right.prototype) return true;
    proto = Object.getPrototypeof(proto);
  }
}
```

<https://blog.shenzjd.com/pages/15beed3c2f8d4/#%E5%AE%9E%E7%8E%B0-instanceof-%E5%8A%9F%E8%83%BD>

## 多维数组拍平

```js
while (ary.some(Array.isArray)) {
  ary = [].concat(...ary);
}
```

<https://blog.shenzjd.com/pages/6bc4ef1017adc/>

## settimeout 模拟实现 setinterval

```js
function mySetinterVal(cb, delay) {
  setTimeout(() => {
    cb();
    mySetinterVal(cb, delay);
  }, delay);
}
mySetinterVal(() => {
  console.log(1);
}, 1000);
```

## setInterval 模拟实现 setTimeout

```js
function mySetTimeout(cb, delay) {
  const timer = setInterval(() => {
    cb();
    clearInterval(timer);
  }, delay);
}

mySetTimeout(() => {
  console.log(1);
}, 1000);
```

## 手写 call

```js
Function.prototype.call = function (context, ...args) {
  let context = context || window;
  context.fn = this;
  let res = context.fn(...args);
  delete context.fn;
  return res;
};
```

## 手写 apply

```js
Function.prototype.call = function (context, args) {
  let context = context || window;
  context.fn = this;
  let res = context.fn(...args);
  delete context.fn;
  return res;
};
```

## 手写 bind

```js
Function.prototype.bind = function (context, ...args) {
  if (typeof context !== "function") throw typeError();
  let that = this;
  let rfn = function () {
    that.call(context, ...args, arguments);
  };
  if (this.prototype) {
    rfn.prototype = Object.create(this.prototype);
  }
  return rfn;
};
```

## 手写 new

```js
function MyNew(ctor, ...args) {
  if (typeof ctor !== "function") throw " ctor must be a function";
  let obj = Object.create(ctor.prototype);
  // let obj = new Object();
  // obj.prototype = Object.create(ctor.prototype);
  let res = ctor.call(obj, ...args);
  let isObject = typeof res === "object" && res !== null;
  let isFunction = typeof res === "function";
  return isObject || isFunction ? res : obj;
}
```

## 正则模拟 trim 方法

```js
String.prototype.strim1 = function () {
  return this.replace(/(^\s+|\s+$)/g, "");
};
String.prototype.strim2 = function () {
  return this.replace(/^\s+(.*?)\s+$/g, "$1");
};

let str = "     dsfd    ";

console.log(str, 1);
console.log(str.trim(), 2);
console.log(str.strim1(), 3);
console.log(str.strim2(), 4);
```

## 手机号 3-4-4 分割

```js
const splitMobile = (mobile, format = "-") => {
  return String(mobile).replace(/(?=(\d{4})+$)/g, format);
};
console.log(splitMobile(13785241526));
```

## 参考链接

- <https://github.com/qianlongo/fe-handwriting>
- <https://juejin.cn/post/6968713283884974088>
